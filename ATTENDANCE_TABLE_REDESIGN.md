# 勤怠一覧テーブル 再設計案

## 1. 現状の課題
- 操作列と多くの時間系列が並び、モバイルでは横スクロールが前提のため視認性が低い【F:index.html†L450-L518】。
- 休憩・勤務時間・振替・備考など詳細列が同一レベルで露出し、主要指標（出勤/退勤/残業）の確認が埋もれている【F:index.html†L500-L511】。
- フィルター条件の表示とテーブルが分離しており、選択中の条件がスクロールで見失われやすい【F:index.html†L474-L495】。

## 2. 目標
1. 「今なにを見るか」を明確にし、主要指標を最小スクロールで確認できること。
2. スマホではカード型で縦読みでき、デスクトップでは列比較がしやすい二段構えを用意すること。
3. 編集・振替・メモ追加などの操作を、行ヘッダー付近にまとめて迷わないようにすること。

## 3. レイアウト案
### 3-1. 2レイヤー表示
- **プライマリ列**（常時表示・狭幅）：操作／日付／氏名／シフト／出勤／退勤／残業。
- **詳細トグル**：行末に「詳細▼」を置き、展開時に休憩・勤務時間・振替・備考・原価コードなどの補足を縦に表示（スマホでは折り畳みカード、デスクトップでは行内のサブ行）。
- **固定ヘッダー**：フィルター条件バーと合計サマリーをテーブル上部にスティッキー表示し、スクロール中も現在の絞り込みと月次合計を確認できるようにする。

### 3-2. モバイルカード
- 1行=1カードとし、上段に日付・シフト・残業バッジ、右上に操作アイコン（編集／コピー／削除）。
- 中段に出勤〜退勤のタイムライン（「09:00 → 18:00 (+1:00 休憩)」）、下段に残業・振替・備考をチップ化。
- カード同士の余白を最小化し、2列グリッドよりも単列縦並びを優先して折り返し崩れを防ぐ。

### 3-3. デスクトップテーブル
- 最小幅800pxを確保し、操作列と日付列を左固定、残業列を右固定。中央部に時間系列を集約。
- 「出勤」「退勤」をカラーラベル（遅刻・早退は色分け）で示し、残業列はアイコン＋色で閾値超過を警告。
- ホバー時に行全体をハイライトし、クリックで詳細サブ行がスライド展開。

## 4. 操作導線
- 行左端に縦型ボタン群（編集／複製／削除）を配置し、マウスホバー時にラベル表示、タップ時はモーダル。
- 行右端の「…」メニューに「振替登録」「備考追加」「CSV出力」をまとめ、主要アクションとの階層を分ける。
- 出退勤が空の行にはアクセント背景を敷き、未入力・下書き状態を明示。

## 5. データ可視化
- テーブル上部に「当月合計」帯を設置し、勤務時間／残業／休暇使用数をアイコン付きで表示。
- 残業超過の行には左端に色付きバーを付け、視線誘導を高める。
- フィルター結果件数と選択月を常時表示し、エクスポート時の条件を明記する。

## 6. 実装ステップ（例）
1. フィルターとサマリーを `position: sticky` で固定し、`monthlySummary` と `attendanceFilterSummary` を結合したステータスバーを作成。
2. テーブル本体を `primary` / `details` の2段構造に分割し、`details` を折り畳みコンポーネントとして再利用可能にする。
3. モバイルブレークポイントでカード表示に切り替える `display: grid` + `@media` を用意し、テーブルと同じデータソースを `renderCardList()` によって出力。
4. 行アクション用の共通ドロップダウンを設け、操作ボタンの数を減らしつつアクセシビリティラベルを付与。
5. ハイライト・バッジ・警告色のトークンを決め、残業超過や未入力の状態表示を統一。
6. 合計／平均を計算するロジックを集計APIに追加し、UIの帯と連動させる。
