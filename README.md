# 出退勤管理システム - つなぐいわてまち

一般社団法人つなぐいわてまち様向けの社内用出退勤管理Webアプリケーションです。

## 🎯 プロジェクト概要

従業員の出退勤打刻、勤怠データの管理・出力を簡単に行えるシンプルで使いやすいWebアプリケーションです。ブラウザがあればどこからでもアクセス可能で、スマートフォンにも対応しています。

## ✅ 実装済み機能

### 1. ログイン機能
- 社員番号による簡易ログイン
- ログイン状態の保持（ブラウザを閉じても継続）
- 管理者・一般ユーザーの権限管理

### 2. 出退勤打刻機能
- ワンクリックで出勤・退勤を記録
- シフト種別の選択（**早番 / 遅番 / 休日出勤**）
- リアルタイムの時計表示
- 本日の勤務状況の表示
- 勤務時間・休憩時間の自動計算
  - 6時間以上勤務: 45分休憩を自動控除
  - 8時間以上勤務: 60分休憩を自動控除

### 3. 休日出勤と振替休暇管理 ⭐ NEW
- **休日出勤時の自動振替計算**
  - 5時間以上の勤務 → 1日分の振替休暇
  - 5時間未満の勤務 → 実時間の振替（例: 4時間）
- **振替休暇の蓄積管理**
  - 従業員ごとの振替残高を自動集計
  - 勤怠一覧画面に「休日出勤サマリー」として表示
- **振替休暇の使用機能**
  - ワンクリックで振替を消化
  - 古い振替から順に消費
  - 使用履歴の記録

### 4. 勤怠データ管理
- 全従業員の勤怠記録一覧表示
- **勤怠情報の編集機能** ⭐ NEW
  - 出勤・退勤時刻の修正
  - シフト種別の変更
  - 備考の追加・編集
- 月別フィルタリング機能（修正済み）
- 日付・従業員名・シフト・出退勤時刻・勤務時間・振替情報の表示
- 見やすいテーブル形式での表示

### 5. データ出力機能
- CSV形式でのエクスポート
- 期間指定によるデータ抽出
- Excel等での開封に対応（BOM付きUTF-8）
- 出力項目: 日付、氏名、シフト、出退勤時刻、休憩時間、勤務時間、振替情報、備考

### 6. 従業員管理機能（管理者のみ）
- 従業員の追加・編集・削除
- 社員番号・氏名・権限の管理
- 有効/無効の切り替え

### 7. UI/UX
- レスポンシブデザイン（PC・タブレット・スマートフォン対応）
- 企業ロゴとブランドカラーの統一
- 直感的な操作性
- トースト通知による操作フィードバック

## 📁 プロジェクト構成

```
/
├── index.html              # メインHTMLファイル
├── js/
│   └── app.js             # アプリケーションロジック
├── images/
│   └── logo.png           # つなぐいわてまちロゴ
└── README.md              # このファイル
```

## 🗄️ データ構造

### employeesテーブル（従業員情報）
- `id`: 従業員ID（自動生成）
- `employee_number`: 社員番号（ログイン用）
- `name`: 氏名
- `role`: 権限（admin/user）
- `is_active`: 有効/無効

### attendanceテーブル（勤怠記録）
- `id`: 勤怠記録ID（自動生成）
- `employee_id`: 従業員ID
- `employee_name`: 従業員名
- `date`: 日付（YYYY-MM-DD）
- `shift_type`: シフト種別（早番/遅番/休日出勤）
- `clock_in`: 出勤時刻（HH:MM）
- `clock_out`: 退勤時刻（HH:MM）
- `break_minutes`: 休憩時間（分）
- `work_hours`: 勤務時間（時間）
- `note`: 備考

### compensatory_leaveテーブル（振替休暇管理） ⭐ NEW
- `id`: 振替休暇ID（自動生成）
- `employee_id`: 従業員ID
- `employee_name`: 従業員名
- `earned_date`: 取得日（休日出勤日）
- `earned_hours`: 取得時間
- `earned_days`: 取得日数
- `used_date`: 使用日
- `used_hours`: 使用時間
- `used_days`: 使用日数
- `status`: ステータス（available/used）
- `note`: 備考

## 🚀 使い方

### 初回セットアップ
1. プロジェクトをデプロイ（Publishタブから公開）
2. デフォルトユーザーでログイン
   - 管理者アカウント: `001`
   - 一般ユーザー: `002`, `003`, `004`, `005`

### 日常的な使用方法

#### 【従業員】出退勤の打刻
1. 社員番号でログイン
2. シフト種別（早番/遅番/休日出勤）を選択
3. 「出勤」ボタンをクリック
4. 業務終了時に「退勤」ボタンをクリック

#### 【従業員】休日出勤の場合
1. シフト種別で「**休日出勤**」を選択
2. 通常通り出勤・退勤を打刻
3. 退勤時に自動的に振替休暇が計算・記録されます
   - 5時間以上勤務: 1日分の振替
   - 5時間未満勤務: 実時間の振替

#### 【従業員】自分の勤怠確認
1. 「勤怠一覧」タブをクリック
2. 月フィルターで確認したい月を選択
3. 「絞り込み」ボタンをクリック

#### 【従業員】振替休暇の確認と使用
1. 「勤怠一覧」タブの上部「休日出勤サマリー」で蓄積を確認
2. 「振替使用」ボタンをクリックして振替を消化
3. 古い振替から自動的に使用されます

#### 【管理者】勤怠情報の修正
1. 「勤怠一覧」で該当の勤怠データを探す
2. 「編集」ボタン（鉛筆アイコン）をクリック
3. 出勤・退勤時刻、シフト種別、備考を修正
4. 「保存」ボタンで更新

#### 【管理者】データ出力
1. 「データ出力」タブをクリック
2. 開始日と終了日を選択
3. 「CSVファイルをダウンロード」をクリック
4. ダウンロードしたファイルをExcelで開く

#### 【管理者】従業員管理
1. 「従業員管理」タブをクリック
2. 「従業員を追加」ボタンで新規追加
3. 編集・削除ボタンで既存データを管理

## 🎨 技術スタック

- **HTML5**: セマンティックな構造
- **Tailwind CSS**: 効率的なスタイリング
- **Vanilla JavaScript**: 軽量でシンプルな実装
- **Font Awesome**: アイコン
- **RESTful Table API**: データの永続化

## 📊 データ保存について

- データは**クラウドデータベース**に自動保存されます
- ブラウザを閉じてもデータは消えません
- 複数端末から同時アクセス可能
- 自動バックアップ機能あり

## 🔐 セキュリティ

- 社員番号による認証
- 管理者権限による機能制限
- ログイン状態の永続化
- 不正なアクセスの防止

## 📱 対応ブラウザ

- Google Chrome（推奨）
- Microsoft Edge
- Safari
- Firefox
- モバイルブラウザ全般

## 🎯 今後の拡張可能な機能

現在のシステムは基本機能＋休日出勤管理機能を完備していますが、以下の機能追加が可能です：

### 短期的に追加可能
- [ ] 残業時間のアラート機能
- [ ] 打刻忘れ通知
- [ ] 月次集計レポート
- [ ] グラフによる可視化（Chart.js使用）
- [ ] 振替休暇の有効期限管理

### 中期的に追加可能
- [ ] 有給休暇管理
- [ ] 休暇申請・承認フロー
- [ ] 複雑なシフトパターン対応
- [ ] QRコード打刻
- [ ] 多言語対応（英語・中国語等）
- [ ] ダークモード切替

### 制約事項（静的Webアプリの限界）
以下の機能は静的Webアプリでは実装できません：
- ❌ メール通知の自動送信
- ❌ 生体認証（指紋・顔認証）
- ❌ 専用ハードウェアとの連携
- ❌ サーバー側での定期バッチ処理

## 💡 推奨される運用方法

1. **毎日**: 従業員が出退勤時に打刻
2. **毎週**: 管理者が勤怠一覧で確認
3. **毎月末**: CSV出力して給与計算に活用
4. **定期**: 従業員の追加・変更を管理
5. **休日出勤時**: 振替休暇の蓄積と消化を管理

## 📝 振替休暇の運用ルール

### 振替の計算方法
- **5時間以上の休日出勤**: 1日分の振替休暇
- **5時間未満の休日出勤**: 実時間分の振替（例: 4時間）

### 振替の蓄積
- 土曜日6時間出勤 → 1日分の振替
- 日曜日4時間出勤 → 4時間分の振替
- **合計**: 1日 + 4時間の振替蓄積

### 振替の使用
- 勤怠一覧画面の「休日出勤サマリー」から使用
- 「振替使用」ボタンをクリック
- 古い振替から順に消化される
- 使用日が自動記録される

## 📞 サポート

システムに関するご質問や改善要望がございましたら、管理者にお問い合わせください。

---

## 🔄 更新履歴

### v1.1.0 (2025-12-17)
- ✅ 休日出勤シフトの追加
- ✅ 振替休暇管理機能の実装
- ✅ 勤怠情報編集機能の追加
- ✅ 月別絞り込み機能の修正
- ✅ UI/UXの改善

### v1.0.0 (2025-12-17)
- ✅ 基本的な出退勤管理機能
- ✅ 従業員管理機能
- ✅ データ出力機能

---

**開発日**: 2025年12月17日  
**バージョン**: 1.1.0  
**対象組織**: 一般社団法人つなぐいわてまち
